---
interface Props {
  variant?: "light" | "dark";
  theme?: "analytics" | "tech" | "growth" | "email";
}

const { variant = "light", theme = "analytics" } = Astro.props;
const uniqueId = `wireframe-${theme}-${Math.random().toString(36).substring(2, 9)}`;

// Theme-spezifische Farben
const isDark = variant === "dark";
const strokeColor = isDark ? "#b4e565" : "#4f3ca2";
const fillColor = isDark
  ? "rgba(180, 229, 101, 0.1)"
  : "rgba(79, 60, 162, 0.1)";
const accentColor = isDark ? "#9dd84f" : "#6b5bb5";
---

<div
  class="pointer-events-none absolute inset-0 flex items-center justify-center overflow-hidden"
  data-variant={variant}
>
  <svg
    id={uniqueId}
    viewBox="50 80 300 180"
    class="h-full max-h-[400px] w-full max-w-[500px]"
  >
    <defs>
      <linearGradient
        id={`grad-${uniqueId}`}
        x1="0%"
        y1="0%"
        x2="100%"
        y2="100%"
      >
        <stop offset="0%" stop-color={strokeColor} stop-opacity="0.6"></stop>
        <stop offset="100%" stop-color={accentColor} stop-opacity="0.4"></stop>
      </linearGradient>

      <clipPath id={`clip-${uniqueId}`}>
        <rect x="50" y="80" width="300" height="180" rx="8"></rect>
      </clipPath>
    </defs>

    <g clip-path={`url(#clip-${uniqueId})`}>
      {/* Analytics Dashboard Wireframe - Cropped View */}
      {
        theme === "analytics" && (
          <g class="wireframe-group">
            {/* Chart Area Background */}
            <rect
              x="50"
              y="70"
              width="300"
              height="140"
              fill="none"
              stroke={strokeColor}
              stroke-width="1.5"
              stroke-dasharray="4,4"
              rx="4"
              opacity="0.4"
            />

            {/* Bar Chart Bars - Animated */}
            <rect
              x="70"
              y="150"
              width="30"
              height="40"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="1.5"
              class="bar bar-1"
            />
            <rect
              x="120"
              y="130"
              width="30"
              height="60"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="1.5"
              class="bar bar-2"
            />
            <rect
              x="170"
              y="110"
              width="30"
              height="80"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="1.5"
              class="bar bar-3"
            />
            <rect
              x="220"
              y="140"
              width="30"
              height="50"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="1.5"
              class="bar bar-4"
            />
            <rect
              x="270"
              y="120"
              width="30"
              height="70"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="1.5"
              class="bar bar-5"
            />

            {/* Axis Lines */}
            <line
              x1="60"
              y1="190"
              x2="320"
              y2="190"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.4"
            />
            <line
              x1="60"
              y1="80"
              x2="60"
              y2="190"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.4"
            />

            {/* Stats Cards */}
            <rect
              x="60"
              y="220"
              width="85"
              height="35"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="1.5"
              rx="4"
              class="element el-3"
            />
            <rect
              x="160"
              y="220"
              width="85"
              height="35"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="1.5"
              rx="4"
              class="element el-4"
            />
            <rect
              x="260"
              y="220"
              width="85"
              height="35"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="1.5"
              rx="4"
              class="element el-5"
            />

            {/* Small text lines in stats */}
            <line
              x1="70"
              y1="230"
              x2="95"
              y2="230"
              stroke={strokeColor}
              stroke-width="1.5"
              opacity="0.6"
            />
            <line
              x1="70"
              y1="245"
              x2="125"
              y2="245"
              stroke={strokeColor}
              stroke-width="2"
            />
          </g>
        )
      }

      {/* Tech/Innovation Circuit Wireframe - Cropped View */}
      {
        theme === "tech" && (
          <g class="wireframe-group">
            {/* Circuit Nodes */}
            <circle
              cx="100"
              cy="110"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-1"
            />
            <circle
              cx="200"
              cy="100"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-2"
            />
            <circle
              cx="300"
              cy="120"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-3"
            />

            <circle
              cx="150"
              cy="180"
              r="25"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="2.5"
              class="node node-center"
            />
            <circle
              cx="250"
              cy="190"
              r="25"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="2.5"
              class="node node-center-2"
            />

            <circle
              cx="100"
              cy="240"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-4"
            />
            <circle
              cx="200"
              cy="235"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-5"
            />
            <circle
              cx="300"
              cy="245"
              r="20"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              class="node node-6"
            />

            {/* Connection Lines - Animated */}
            <line
              x1="110"
              y1="125"
              x2="140"
              y2="165"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-1"
              opacity="0.6"
            />
            <line
              x1="205"
              y1="120"
              x2="160"
              y2="160"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-2"
              opacity="0.6"
            />
            <line
              x1="285"
              y1="130"
              x2="265"
              y2="170"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-3"
              opacity="0.6"
            />

            <line
              x1="140"
              y1="200"
              x2="110"
              y2="225"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-4"
              opacity="0.6"
            />
            <line
              x1="165"
              y1="200"
              x2="190"
              y2="220"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-5"
              opacity="0.6"
            />
            <line
              x1="260"
              y1="210"
              x2="290"
              y2="235"
              stroke={strokeColor}
              stroke-width="2"
              class="connection c-6"
              opacity="0.6"
            />

            <line
              x1="175"
              y1="180"
              x2="225"
              y2="190"
              stroke={accentColor}
              stroke-width="3"
              class="connection c-main"
            />

            {/* Small icons in nodes */}
            <circle
              cx="100"
              cy="110"
              r="6"
              fill={strokeColor}
              class="inner-dot"
            />
            <circle
              cx="200"
              cy="100"
              r="6"
              fill={strokeColor}
              class="inner-dot"
            />
            <circle
              cx="300"
              cy="120"
              r="6"
              fill={strokeColor}
              class="inner-dot"
            />
          </g>
        )
      }

      {/* Growth - Cropped Staircase View */}
      {
        theme === "growth" && (
          <g class="wireframe-group">
            {/* Staircase/Progress Steps - Centered in viewport */}
            <rect
              x="60"
              y="180"
              width="60"
              height="60"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              rx="4"
              class="step step-1"
            />
            <rect
              x="130"
              y="140"
              width="60"
              height="100"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              rx="4"
              class="step step-2"
            />
            <rect
              x="200"
              y="100"
              width="60"
              height="140"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="2"
              rx="4"
              class="step step-3"
            />
            <rect
              x="270"
              y="85"
              width="60"
              height="155"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="2.5"
              rx="4"
              class="step step-4"
            />

            {/* Progress Labels */}
            <line
              x1="70"
              y1="195"
              x2="100"
              y2="195"
              stroke={strokeColor}
              stroke-width="1.5"
              opacity="0.6"
            />
            <line
              x1="140"
              y1="165"
              x2="170"
              y2="165"
              stroke={strokeColor}
              stroke-width="1.5"
              opacity="0.6"
            />
            <line
              x1="210"
              y1="125"
              x2="240"
              y2="125"
              stroke={strokeColor}
              stroke-width="1.5"
              opacity="0.6"
            />
            <line
              x1="280"
              y1="100"
              x2="310"
              y2="100"
              stroke={accentColor}
              stroke-width="2"
              opacity="0.7"
            />

            {/* Trend Line Overlay */}
            <polyline
              points="90,210 160,165 230,122 300,95"
              fill="none"
              stroke={strokeColor}
              stroke-width="2"
              opacity="0.4"
              stroke-dasharray="5,5"
              class="trend-line"
            />

            {/* Arrow */}
            <path
              d="M 340,85 L 350,95 L 345,95 L 345,105 L 340,105 Z"
              fill={accentColor}
              stroke={strokeColor}
              stroke-width="1.5"
              class="arrow-up"
              opacity="0.8"
            />
          </g>
        )
      }

      {/* Email - Cropped List View */}
      {
        theme === "email" && (
          <g class="wireframe-group">
            {/* Email List View - Centered */}
            <rect
              x="60"
              y="90"
              width="280"
              height="50"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="1.5"
              rx="4"
              class="email email-1"
            />
            <rect
              x="60"
              y="150"
              width="280"
              height="50"
              fill={fillColor}
              stroke={strokeColor}
              stroke-width="1.5"
              rx="4"
              class="email email-2"
            />
            <rect
              x="60"
              y="210"
              width="280"
              height="50"
              fill={`url(#grad-${uniqueId})`}
              stroke={strokeColor}
              stroke-width="2"
              rx="4"
              class="email email-3"
            />

            {/* Email Icons/Checkboxes */}
            <circle
              cx="75"
              cy="115"
              r="8"
              fill="none"
              stroke={strokeColor}
              stroke-width="1.5"
              class="checkbox"
            />
            <circle
              cx="75"
              cy="175"
              r="8"
              fill="none"
              stroke={strokeColor}
              stroke-width="1.5"
              class="checkbox"
            />
            <circle
              cx="75"
              cy="235"
              r="8"
              fill={accentColor}
              stroke={strokeColor}
              stroke-width="1.5"
              class="checkbox checked"
            />
            <path
              d="M 72,235 L 74,237 L 78,233"
              stroke="white"
              stroke-width="2"
              fill="none"
            />

            {/* Email Content Lines */}
            <line
              x1="95"
              y1="105"
              x2="180"
              y2="105"
              stroke={strokeColor}
              stroke-width="2"
              class="subject"
            />
            <line
              x1="95"
              y1="115"
              x2="250"
              y2="115"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />
            <line
              x1="95"
              y1="123"
              x2="200"
              y2="123"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />

            <line
              x1="95"
              y1="165"
              x2="180"
              y2="165"
              stroke={strokeColor}
              stroke-width="2"
              class="subject"
            />
            <line
              x1="95"
              y1="175"
              x2="250"
              y2="175"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />
            <line
              x1="95"
              y1="183"
              x2="200"
              y2="183"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />

            <line
              x1="95"
              y1="225"
              x2="180"
              y2="225"
              stroke={strokeColor}
              stroke-width="2"
              class="subject"
            />
            <line
              x1="95"
              y1="235"
              x2="250"
              y2="235"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />
            <line
              x1="95"
              y1="243"
              x2="200"
              y2="243"
              stroke={strokeColor}
              stroke-width="1"
              opacity="0.5"
            />

            {/* Time/Date stamps */}
            <text
              x="320"
              y="110"
              font-size="10"
              fill={strokeColor}
              opacity="0.6"
              text-anchor="end"
            >
              12:30
            </text>
            <text
              x="320"
              y="170"
              font-size="10"
              fill={strokeColor}
              opacity="0.6"
              text-anchor="end"
            >
              10:15
            </text>
            <text
              x="320"
              y="230"
              font-size="10"
              fill={strokeColor}
              opacity="0.6"
              text-anchor="end"
            >
              09:45
            </text>
          </g>
        )
      }
    </g>
  </svg>
</div>

<script is:inline define:vars={{ uniqueId, theme }}>
  import anime from "animejs/lib/anime.es.js";

  function initWireframe() {
    const svg = document.getElementById(uniqueId);
    if (!svg) return;

    // Analytics Theme - Bars grow
    if (theme === "analytics") {
      anime({
        targets: `#${uniqueId} .bar`,
        scaleY: [{ value: 0.7 }, { value: 1.2 }, { value: 1 }],
        transformOrigin: "bottom",
        duration: 2000,
        easing: "easeInOutQuad",
        loop: true,
        delay: anime.stagger(200),
      });

      anime({
        targets: `#${uniqueId} .element`,
        opacity: [0.3, 0.8, 0.5],
        duration: 3000,
        easing: "easeInOutSine",
        loop: true,
        delay: anime.stagger(300),
      });
    }

    // Tech Theme - Pulse connections
    if (theme === "tech") {
      anime({
        targets: `#${uniqueId} .node`,
        scale: [1, 1.15, 1],
        duration: 2500,
        easing: "easeInOutQuad",
        loop: true,
        delay: anime.stagger(150),
      });

      anime({
        targets: `#${uniqueId} .connection`,
        strokeWidth: [2, 4, 2],
        opacity: [0.4, 0.9, 0.6],
        duration: 2000,
        easing: "easeInOutSine",
        loop: true,
        delay: anime.stagger(200),
      });

      anime({
        targets: `#${uniqueId} .node-center, #${uniqueId} .node-center-2`,
        scale: [1, 1.2, 1],
        opacity: [0.8, 1, 0.8],
        duration: 1500,
        easing: "easeInOutQuad",
        loop: true,
      });
    }

    // Growth Theme - Steps build up
    if (theme === "growth") {
      anime({
        targets: `#${uniqueId} .step`,
        scaleY: [{ value: 0.3 }, { value: 1.05 }, { value: 1 }],
        transformOrigin: "bottom",
        duration: 2500,
        easing: "easeInOutCubic",
        loop: true,
        delay: anime.stagger(300),
      });

      anime({
        targets: `#${uniqueId} .arrow-up`,
        translateY: [0, -10, 0],
        opacity: [0.6, 1, 0.8],
        duration: 2000,
        easing: "easeInOutQuad",
        loop: true,
      });

      anime({
        targets: `#${uniqueId} .trend-line`,
        strokeDashoffset: [0, -30],
        opacity: [0.3, 0.6, 0.4],
        duration: 3000,
        easing: "linear",
        loop: true,
      });
    }

    // Email Theme - Emails slide in and highlight
    if (theme === "email") {
      anime({
        targets: `#${uniqueId} .email`,
        translateX: [{ value: -5 }, { value: 0 }],
        opacity: [0.6, 1, 0.8],
        duration: 2500,
        easing: "easeInOutQuad",
        loop: true,
        delay: anime.stagger(400),
      });

      anime({
        targets: `#${uniqueId} .checked`,
        scale: [1, 1.2, 1],
        duration: 1500,
        easing: "easeInOutQuad",
        loop: true,
      });
    }

    // General subtle float for all themes
    anime({
      targets: `#${uniqueId}`,
      translateY: [0, -5, 0],
      duration: 4000,
      easing: "easeInOutSine",
      loop: true,
    });
  }

  // Initialize
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", initWireframe);
  } else {
    initWireframe();
  }

  // Re-initialize on page load
  document.addEventListener("astro:page-load", initWireframe);
</script>

<style>
  svg {
    filter: drop-shadow(0 2px 10px rgba(0, 0, 0, 0.05));
  }

  [data-variant="dark"] svg {
    filter: drop-shadow(0 2px 15px rgba(180, 229, 101, 0.15));
  }
</style>
