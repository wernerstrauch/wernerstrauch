---
import FooterCTA from "@components/shared/FooterCTA.astro";
import StarField from "@components/shared/StarField.astro";
import { Icon } from "astro-icon/components";
import { Image } from "astro:assets";
import { getCurrentDomain, SOCIALS, SITE } from "@config";

const domain = getCurrentDomain();
const { logo, navigation: domainNav } = domain;

interface Props {
  cta?: boolean;
}

const { cta = true } = Astro.props;

// Use footer navigation from domain config
const navigation = domainNav.footer.columns;
---

<section class:list={[cta && "overflow-hidden"]}>
  <div class="relative">
    {cta && <FooterCTA />}

    {/* Stars */}
    <div
      class="absolute -bottom-4 left-1/2 -z-10 h-48 w-full max-w-3xl -translate-x-1/2 md:-bottom-8 md:h-64 lg:-bottom-12"
      aria-hidden="true"
    >
      <StarField density="medium" maxRadius={2.5} />
    </div>
  </div>
  <div
    class="footer__border relative top-2 left-1/2 w-[350%] -translate-x-1/2 rounded-t-[100%] p-[0.5px] sm:w-[250%] md:top-4 md:w-[200%] lg:top-10 lg:w-[150%] xl:w-[125%]"
  >
    <div
      class="footer__bg h-full w-full rounded-t-[100%] pt-24 pb-16 sm:pt-28 md:pt-32 lg:pt-40"
    >
      <div class="mx-auto w-screen">
        <div
          class="mx-auto max-w-lg px-5 sm:max-w-xl sm:px-6 md:max-w-3xl lg:max-w-(--breakpoint-xl) lg:px-8"
        >
          <div
            class:list={[
              "grid grid-cols-2 gap-12 sm:gap-16 lg:gap-8",
              navigation.length <= 4
                ? "md:grid-cols-2 lg:grid-cols-4"
                : "md:grid-cols-3 lg:grid-cols-5",
            ]}
          >
            {
              navigation.map((navCol) => (
                <div class="flex lg:justify-center">
                  <div class="flex flex-col">
                    <h4 class="footer__nav-label flex flex-col align-middle text-sm font-semibold">
                      {navCol.label}
                    </h4>
                    <ul class="mt-4 space-y-3">
                      {navCol.links.map((link) => (
                        <li class="group relative flex items-center">
                          <a
                            href={link.href}
                            class="footer__nav-link text-sm leading-none font-semibold"
                          >
                            {link.name}
                          </a>
                        </li>
                      ))}
                    </ul>
                  </div>
                </div>
              ))
            }
          </div>
          <div
            class="shadow-inner-blur mt-16 block w-full rounded-2xl bg-zinc-950/[.01] sm:mt-24"
          >
            <div
              class="footer__bottom-bar flex w-full items-center justify-between space-x-5 rounded-2xl border px-6 py-4 sm:space-x-8 sm:px-8 sm:py-6"
            >
              {/* Logo */}
              <div class="flex shrink-0 items-center">
                <a
                  href="/"
                  aria-label="Home"
                  class="flex shrink-0 items-center"
                >
                  {
                    logo.image ? (
                      <Image
                        src={logo.image}
                        alt={logo.alt}
                        width={logo.width}
                        height={logo.height}
                        class="h-6 w-auto sm:h-7 xl:h-8"
                      />
                    ) : (
                      <img
                        src={logo.src}
                        alt={logo.alt}
                        width={logo.width}
                        height={logo.height}
                        class="h-6 w-auto sm:h-7 xl:h-8"
                      />
                    )
                  }
                </a>
              </div>
              <div
                class="flex items-center space-x-5 sm:space-x-7 lg:space-x-6 xl:space-x-12"
              >
                {
                  SOCIALS.map((social) => (
                    <a
                      href={social.href}
                      aria-label={social.ariaLabel}
                      class="footer__social group flex items-center space-x-2 text-sm font-semibold"
                    >
                      <Icon
                        name={`nucleo/${social.name}`}
                        class="footer__social-icon h-4 w-4 duration-200 ease-in-out"
                      />
                      <span class="footer__social-label hidden duration-200 ease-in-out lg:inline">
                        {social.label}
                      </span>
                    </a>
                  ))
                }
              </div>
            </div>
          </div>
          <p class="footer__copyright mt-10 text-center text-[15px] sm:mt-12">
            Â© {new Date().getFullYear()}
            {SITE.title}. Alle Rechte vorbehalten.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  @reference "../../styles/styles.css";

  .footer__border {
    background: linear-gradient(
      to right,
      transparent,
      color-mix(in srgb, var(--primary-light) 15%, transparent),
      transparent
    );
  }

  .footer__bg {
    background:
      linear-gradient(rgba(24, 24, 27, 0.9), rgba(24, 24, 27, 0.9)),
      linear-gradient(var(--primary-dark), var(--primary-dark));
  }

  .footer__nav-label {
    color: var(--color-zinc-400);
  }

  .footer__nav-line {
    background: linear-gradient(
      to bottom,
      color-mix(in srgb, var(--primary-light) 12%, transparent),
      color-mix(in srgb, var(--primary-light) 4%, transparent)
    );
  }

  .footer__nav-link {
    color: var(--color-gray-100);
  }

  .footer__nav-link:hover {
    color: var(--primary-light);
  }

  .footer__nav-indicator {
    background: linear-gradient(
      to bottom,
      transparent,
      color-mix(in srgb, var(--primary-light) 90%, transparent),
      transparent
    );
  }

  .footer__bottom-bar {
    border-color: color-mix(in srgb, var(--primary-light) 6%, transparent);
  }

  .footer__social {
    color: var(--color-gray-100);
    filter: drop-shadow(
      -2px -4px 6px color-mix(in srgb, var(--primary-light) 20%, transparent)
    );
  }

  .footer__social-icon:hover,
  .footer__social:hover .footer__social-icon {
    color: var(--primary);
  }

  .footer__social-label:hover,
  .footer__social:hover .footer__social-label {
    color: var(--primary-light);
  }

  .footer__copyright {
    color: color-mix(in srgb, var(--color-zinc-400) 90%, transparent);
  }
</style>
