---
// FluidBackground.astro - Subtle animated glow background
interface Props {
  class?: string;
  intensity?: "subtle" | "medium" | "strong";
  speed?: "slow" | "medium" | "fast";
  position?:
    | "center"
    | "top"
    | "bottom"
    | "left"
    | "right"
    | "top-left"
    | "top-right"
    | "bottom-left"
    | "bottom-right";
}

const {
  class: className = "",
  intensity = "medium",
  speed = "slow",
  position = "center",
} = Astro.props;

const intensityMap = {
  subtle: "opacity-[0.015]",
  medium: "opacity-[0.025]",
  strong: "opacity-[0.04]",
};

const speedMap = {
  slow: "30s",
  medium: "20s",
  fast: "12s",
};

const positionMap = {
  center: "left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2",
  top: "left-1/2 top-0 -translate-x-1/2 -translate-y-1/3",
  bottom: "left-1/2 bottom-0 -translate-x-1/2 translate-y-1/3",
  left: "left-0 top-1/2 -translate-x-1/3 -translate-y-1/2",
  right: "right-0 top-1/2 translate-x-1/3 -translate-y-1/2",
  "top-left": "left-0 top-0 -translate-x-1/4 -translate-y-1/4",
  "top-right": "right-0 top-0 translate-x-1/4 -translate-y-1/4",
  "bottom-left": "left-0 bottom-0 -translate-x-1/4 translate-y-1/4",
  "bottom-right": "right-0 bottom-0 translate-x-1/4 translate-y-1/4",
};
---

<!-- Subtle glow background - no overflow hidden to prevent clipping -->
<div
  class:list={[
    "fluid-background pointer-events-none absolute inset-0",
    className,
  ]}
  style={`--animation-duration: ${speedMap[speed]};`}
>
  <!-- Positioned glow with larger size and blur -->
  <div
    class:list={[
      "fluid-glow absolute h-[800px] w-[800px] md:h-[1200px] md:w-[1200px] lg:h-[1600px] lg:w-[1600px]",
      intensityMap[intensity],
      positionMap[position],
    ]}
  >
    <div
      class="fluid-glow__inner absolute inset-0 rounded-full blur-[250px] md:blur-[350px] lg:blur-[450px]"
    >
    </div>
  </div>
</div>

<style>
  @reference "../../styles/styles.css";

  .fluid-background {
    /* Ensure immediate visibility */
    opacity: 1;
    visibility: visible;
  }

  .fluid-glow {
    will-change: transform, opacity;
    animation: glow-pulse var(--animation-duration) ease-in-out infinite;
  }

  .fluid-glow__inner {
    background-color: var(--primary);
  }

  @keyframes glow-pulse {
    0%,
    100% {
      transform: translate(-50%, -50%) scale(1);
      opacity: inherit;
    }
    50% {
      transform: translate(-50%, -50%) scale(1.1);
      opacity: inherit;
    }
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    .fluid-glow {
      animation: none;
    }
  }
</style>
