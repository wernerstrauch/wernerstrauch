---
interface Props {
  color?: string;
  opacity?: number;
  size?: number;
  speed?: "slow" | "medium" | "fast";
}

const {
  color = "#4f3ca2",
  opacity = 0.3,
  size = 2,
  speed = "slow",
} = Astro.props;

const speedDuration = {
  slow: "120s",
  medium: "60s",
  fast: "30s",
};

const duration = speedDuration[speed];
---

<div class="absolute inset-0 overflow-hidden">
  <div
    class="dots-container absolute inset-0"
    style={`--dot-color: ${color}; --dot-opacity: ${opacity}; --dot-size: ${size}px;`}
  >
    <div class="dots-layer dots-layer-1"></div>
    <div class="dots-layer dots-layer-2"></div>
    <div class="dots-layer dots-layer-3"></div>
  </div>
</div>

<style define:vars={{ duration }}>
  .dots-container {
    --dot-spacing: 40px;
  }

  .dots-layer {
    position: absolute;
    inset: -50%;
    width: 200%;
    height: 200%;
    background-image: radial-gradient(
      circle,
      var(--dot-color) var(--dot-size),
      transparent var(--dot-size)
    );
    background-size: var(--dot-spacing) var(--dot-spacing);
    opacity: var(--dot-opacity);
  }

  .dots-layer-1 {
    animation: drift1 var(--duration) linear infinite;
  }

  .dots-layer-2 {
    --dot-spacing: 60px;
    opacity: calc(var(--dot-opacity) * 0.6);
    animation: drift2 calc(var(--duration) * 1.3) linear infinite;
  }

  .dots-layer-3 {
    --dot-spacing: 80px;
    opacity: calc(var(--dot-opacity) * 0.3);
    animation: drift3 calc(var(--duration) * 1.7) linear infinite;
  }

  @keyframes drift1 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(var(--dot-spacing), var(--dot-spacing));
    }
  }

  @keyframes drift2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(calc(var(--dot-spacing) * -1), var(--dot-spacing));
    }
  }

  @keyframes drift3 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(var(--dot-spacing), calc(var(--dot-spacing) * -1));
    }
  }
</style>
