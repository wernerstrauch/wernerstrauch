---
interface Props {
  color?: string;
  opacity?: number;
  position?: "left" | "right" | "center";
  size?: "sm" | "md" | "lg";
  animate?: boolean;
  shape?: "circles" | "squares" | "diamonds" | "hexagons" | "rounded-squares";
  hideOnMobile?: boolean;
}

const {
  color = "#c8ff00",
  opacity = 0.15,
  position = "right",
  size = "lg",
  animate = true,
  shape = "circles",
  hideOnMobile = false,
} = Astro.props;

// Size configurations
const sizes = {
  sm: { outer: 400, middle: 300, inner: 200 },
  md: { outer: 550, middle: 420, inner: 280 },
  lg: { outer: 700, middle: 520, inner: 340 },
};

const currentSize = sizes[size];

// Position configurations
const positions = {
  left: "left: 5%; top: 50%; transform: translateY(-50%);",
  right: "right: 5%; top: 50%; transform: translateY(-50%);",
  center: "left: 50%; top: 50%; transform: translate(-50%, -50%);",
};
---

<div
  class:list={["concentric-shapes-container pointer-events-none absolute", animate && "animate", `shape-${shape}`, hideOnMobile && "hide-on-mobile"]}
  style={positions[position]}
  data-color={color}
  data-shape={shape}
>
  {/* Outer ring */}
  <div
    class="concentric-ring ring-outer absolute"
    style={`
      width: ${currentSize.outer}px;
      height: ${currentSize.outer}px;
      border-color: ${color};
      opacity: ${opacity};
    `}
  />

  {/* Middle ring */}
  <div
    class="concentric-ring ring-middle absolute"
    style={`
      width: ${currentSize.middle}px;
      height: ${currentSize.middle}px;
      border-color: ${color};
      opacity: ${opacity * 1.2};
    `}
  />

  {/* Inner ring */}
  <div
    class="concentric-ring ring-inner absolute"
    style={`
      width: ${currentSize.inner}px;
      height: ${currentSize.inner}px;
      border-color: ${color};
      opacity: ${opacity * 1.5};
    `}
  />

  {/* Optional glow effect in center */}
  <div
    class="concentric-glow absolute"
    style={`
      width: ${currentSize.inner * 0.6}px;
      height: ${currentSize.inner * 0.6}px;
      background: radial-gradient(circle, ${color} 0%, transparent 70%);
      opacity: ${opacity * 0.5};
    `}
  />
</div>

<style is:global>
  .concentric-shapes-container {
    z-index: 0;
  }

  .concentric-shapes-container .concentric-ring {
    border-width: 1px;
    border-style: solid;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .concentric-shapes-container .concentric-glow {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    filter: blur(40px);
  }

  /* ========================================
     Shape: Circles (default)
     ======================================== */
  .concentric-shapes-container.shape-circles .concentric-ring {
    border-radius: 50%;
  }

  .concentric-shapes-container.shape-circles .concentric-glow {
    border-radius: 50%;
  }

  /* ========================================
     Shape: Squares
     ======================================== */
  .concentric-shapes-container.shape-squares .concentric-ring {
    border-radius: 0;
  }

  .concentric-shapes-container.shape-squares .concentric-glow {
    border-radius: 0;
  }

  /* ========================================
     Shape: Diamonds (rotated squares)
     ======================================== */
  .concentric-shapes-container.shape-diamonds .concentric-ring {
    border-radius: 0;
  }

  .concentric-shapes-container.shape-diamonds .ring-outer {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .concentric-shapes-container.shape-diamonds .ring-middle {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .concentric-shapes-container.shape-diamonds .ring-inner {
    transform: translate(-50%, -50%) rotate(45deg);
  }

  .concentric-shapes-container.shape-diamonds .concentric-glow {
    border-radius: 0;
    transform: translate(-50%, -50%) rotate(45deg);
  }

  /* ========================================
     Shape: Hexagons
     ======================================== */
  .concentric-shapes-container.shape-hexagons .concentric-ring {
    border-radius: 0;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    border: none;
    background: transparent;
  }

  .concentric-shapes-container.shape-hexagons .concentric-ring::before {
    content: "";
    position: absolute;
    inset: 0;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    background: linear-gradient(135deg, currentColor 0%, currentColor 100%);
    mask: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    -webkit-mask:
      linear-gradient(#fff 0 0) content-box,
      linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    padding: 1px;
  }

  .concentric-shapes-container.shape-hexagons .concentric-glow {
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
  }

  /* ========================================
     Shape: Rounded Squares
     ======================================== */
  .concentric-shapes-container.shape-rounded-squares .concentric-ring {
    border-radius: 20%;
  }

  .concentric-shapes-container.shape-rounded-squares .concentric-glow {
    border-radius: 20%;
  }

  /* Subtle animation */
  .concentric-shapes-container.animate .ring-outer {
    animation: pulse-outer 8s ease-in-out infinite;
  }

  .concentric-shapes-container.animate .ring-middle {
    animation: pulse-middle 8s ease-in-out infinite;
    animation-delay: 0.5s;
  }

  .concentric-shapes-container.animate .ring-inner {
    animation: pulse-inner 8s ease-in-out infinite;
    animation-delay: 1s;
  }

  .concentric-shapes-container.animate .concentric-glow {
    animation: glow-pulse 4s ease-in-out infinite;
  }

  @keyframes pulse-outer {
    0%, 100% {
      transform: translate(-50%, -50%) scale(1);
      opacity: var(--ring-opacity, 0.15);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.03);
      opacity: calc(var(--ring-opacity, 0.15) * 1.3);
    }
  }

  @keyframes pulse-middle {
    0%, 100% {
      transform: translate(-50%, -50%) scale(1);
      opacity: calc(var(--ring-opacity, 0.15) * 1.2);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.04);
      opacity: calc(var(--ring-opacity, 0.15) * 1.5);
    }
  }

  @keyframes pulse-inner {
    0%, 100% {
      transform: translate(-50%, -50%) scale(1);
      opacity: calc(var(--ring-opacity, 0.15) * 1.5);
    }
    50% {
      transform: translate(-50%, -50%) scale(1.05);
      opacity: calc(var(--ring-opacity, 0.15) * 1.8);
    }
  }

  @keyframes glow-pulse {
    0%, 100% {
      opacity: var(--glow-opacity, 0.075);
      transform: translate(-50%, -50%) scale(1);
    }
    50% {
      opacity: calc(var(--glow-opacity, 0.075) * 1.5);
      transform: translate(-50%, -50%) scale(1.1);
    }
  }

  /* Diamond-specific animations (with rotation) */
  .concentric-shapes-container.shape-diamonds.animate .ring-outer {
    animation: pulse-outer-diamond 8s ease-in-out infinite;
  }

  .concentric-shapes-container.shape-diamonds.animate .ring-middle {
    animation: pulse-middle-diamond 8s ease-in-out infinite;
    animation-delay: 0.5s;
  }

  .concentric-shapes-container.shape-diamonds.animate .ring-inner {
    animation: pulse-inner-diamond 8s ease-in-out infinite;
    animation-delay: 1s;
  }

  .concentric-shapes-container.shape-diamonds.animate .concentric-glow {
    animation: glow-pulse-diamond 4s ease-in-out infinite;
  }

  @keyframes pulse-outer-diamond {
    0%, 100% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1);
      opacity: var(--ring-opacity, 0.15);
    }
    50% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1.03);
      opacity: calc(var(--ring-opacity, 0.15) * 1.3);
    }
  }

  @keyframes pulse-middle-diamond {
    0%, 100% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1);
      opacity: calc(var(--ring-opacity, 0.15) * 1.2);
    }
    50% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1.04);
      opacity: calc(var(--ring-opacity, 0.15) * 1.5);
    }
  }

  @keyframes pulse-inner-diamond {
    0%, 100% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1);
      opacity: calc(var(--ring-opacity, 0.15) * 1.5);
    }
    50% {
      transform: translate(-50%, -50%) rotate(45deg) scale(1.05);
      opacity: calc(var(--ring-opacity, 0.15) * 1.8);
    }
  }

  @keyframes glow-pulse-diamond {
    0%, 100% {
      opacity: var(--glow-opacity, 0.075);
      transform: translate(-50%, -50%) rotate(45deg) scale(1);
    }
    50% {
      opacity: calc(var(--glow-opacity, 0.075) * 1.5);
      transform: translate(-50%, -50%) rotate(45deg) scale(1.1);
    }
  }

  /* Reduce motion support */
  @media (prefers-reduced-motion: reduce) {
    .concentric-shapes-container.animate .ring-outer,
    .concentric-shapes-container.animate .ring-middle,
    .concentric-shapes-container.animate .ring-inner,
    .concentric-shapes-container.animate .concentric-glow {
      animation: none;
    }
  }

  /* Hide on mobile */
  @media (max-width: 1024px) {
    .concentric-shapes-container.hide-on-mobile {
      display: none !important;
    }
  }

  /* Responsive - smaller on mobile */
  @media (max-width: 768px) {
    .concentric-shapes-container .concentric-ring,
    .concentric-shapes-container .concentric-glow {
      transform: translate(-50%, -50%) scale(0.5);
    }
  }
</style>
